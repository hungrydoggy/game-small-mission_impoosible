Obj:
  nam: 'poop'
  #scl: [4, 4, 1]
  ref:
    'type_idx': {'$type_idx': 0}

  dat:
    'is_active': false

  fnc:
    '~setActive':
      '''{(GameObject* self, ,,, vector<Var> msg_params)
        unlikely (msg_params.size() < 1) {
          LOG_ERR("need params --- bool is_active");
          return null_var;
        }

        auto is_active = msg_params[0].as<bool>();
        self->setData("is_active", is_active);
        likely (is_active == true) {
          self->sendMessage("./view", "selectChild", {Var("idle")});
          self->alpha(1);
        }

        likely (is_active == true)
          self->activate();
        else
          self->deactivate();
      '''
    '%onPostBuildBody':
      '''{(GameObject* self, BulletBody* body)
      
        auto bt_body = body->bt_body();
        bt_body->setLinearFactor (btVector3(1, 1, 0));
        bt_body->setAngularFactor(btVector3(0, 0, 0));
      '''
    '%onBeginContact':
      '''{(GameObject* self, BulletShape* my_shape, BulletShape* other_shape, void* contact_info)
        self->sendMessage("./view", "selectChild", {Var("disappear")});
        self->setAction("disappear");
        self->sendMessage(dynamic_cast<GameComponent*>(other_shape->body_owner()), "onHit");
      '''

  chl:
    - Cmp:
      nam: 'view'
      fnc:
        - '@plugins/child_selector/select_child.fnc'
        -
          '%onInit':
            '''{(GameComponent* self)
              self->sendMessage(".", "selectChild", {Var("idle")});
            '''
      chl:
        - Obj:
          nam: 'idle'
          vie:
            Image:
              tex: {'!+':['./normal/', '$type_idx', '.png']}
              siz: {'!relh.pair':[0, 60]}
              mat: 'transparent'
        - Obj:
          nam: 'disappear'
          vie: '@./disappear.spr'
  bdy:
    BulletBody:
      mas: 1
      grp: ['projectile.enemy']
      msk: ['player', 'land']
  shp:
    - BulletBox:
      pos: [0, -2, 0]
      hsz: [11, 11, 100]
  acl:
    - ActionItem:
      nam: 'disappear'
      act:
        Sequence:
          chl:
            - UnregisterBody:
              tar:'.'
            - Wait:
              dur: 0.2
            - AlphaTo:
              dur: 0.2
              val: 0
              int: out_quad
            - SendMessage:
              dst: '.'
              nam: 'setActive'
              par: [false]
